package org.example.model;
/**
 * Интерфейс для безопасного хеширования паролей и проверки их соответствия.
 * Реализации обязаны применять криптографически стойкие алгоритмы и
 * обеспечивать невозможность восстановления исходного пароля из хеша.
 *
 * <p>Типичная реализация: PBKDF2.</p>
 *
 * <p>Возвращаемая строка должна содержать всю информацию,
 * необходимую для последующей проверки (например: соль, количество итераций).</p>
 */
public interface PasswordHasher {

    /**
     * Создаёт криптографически стойкий хеш на основе переданного пароля.
     *
     * @param password исходный пароль (не должен быть null)
     * @return строковое представление хеша, пригодное для хранения в БД
     * @throws IllegalArgumentException если пароль равен null
     */
    String hash(String password);

    /**
     * Проверяет соответствие переданного пароля ранее сохранённому хешу.
     *
     * @param password    пароль в открытом виде
     * @param storedHash  ранее сгенерированный хеш в формате реализации
     * @return true — если пароль корректно совпадает с хешом, иначе false
     */
    boolean verify(String password, String storedHash);
}